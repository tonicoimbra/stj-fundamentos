<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sistema de consulta de fundamentos legais do STJ">
    <title>{% block title %}STJ Fundamentos Legais{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        [x-cloak] { display: none !important; }

        /* Smooth transitions */
        .tree-item { transition: all 0.2s ease; }
        .highlight { background-color: #fef3c7; }

        /* Scroll behavior */
        html { scroll-behavior: smooth; }

        /* Focus visible for accessibility */
        *:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Loading animation */
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .skeleton {
            animation: shimmer 2s infinite linear;
            background: linear-gradient(to right, #f1f5f9 4%, #e2e8f0 25%, #f1f5f9 36%);
            background-size: 1000px 100%;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body.dark {
                background-color: #0f172a;
                color: #f1f5f9;
            }

            body.dark .bg-white {
                background-color: #1e293b;
            }

            body.dark .bg-gray-50 {
                background-color: #0f172a;
            }

            body.dark .text-gray-900 {
                color: #f1f5f9;
            }

            body.dark .border-gray-200,
            body.dark .border-gray-100 {
                border-color: #334155;
            }
        }

        /* Tooltip */
        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 0.5rem;
            background: #1e293b;
            color: white;
            font-size: 0.75rem;
            border-radius: 0.375rem;
            white-space: nowrap;
            z-index: 1000;
            margin-bottom: 0.25rem;
        }

        /* Print styles */
        @media print {
            nav, footer, button, .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen transition-colors" x-data="{ darkMode: false, mobileMenuOpen: false }" :class="{ 'dark': darkMode }">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-blue-600 text-white px-4 py-2 rounded-lg z-50">
        Pular para conteúdo principal
    </a>

    <!-- Navigation -->
    <nav class="bg-blue-800 text-white shadow-lg sticky top-0 z-40" role="navigation" aria-label="Navegação principal">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <a href="{% url 'fundamentos:index' %}" class="text-lg md:text-xl font-bold hover:text-blue-200 transition flex items-center gap-2" aria-label="Página inicial">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path>
                    </svg>
                    <span class="hidden sm:inline">STJ Fundamentos Legais</span>
                    <span class="sm:hidden">STJ</span>
                </a>

                <!-- Desktop menu -->
                <div class="hidden md:flex items-center gap-6">
                    <a href="{% url 'fundamentos:index' %}" class="hover:text-blue-200 transition flex items-center gap-2" aria-label="Página de busca">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        Busca
                    </a>
                    <a href="{% url 'fundamentos:arvore' %}" class="hover:text-blue-200 transition flex items-center gap-2" aria-label="Visualização em árvore">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
                        </svg>
                        Árvore
                    </a>
                    <a href="/api/fundamentos/" class="hover:text-blue-200 transition flex items-center gap-2" aria-label="API REST" target="_blank">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                        </svg>
                        API
                    </a>

                    <!-- Dark mode toggle -->
                    <button @click="darkMode = !darkMode"
                        class="p-2 hover:bg-blue-700 rounded-lg transition"
                        aria-label="Alternar modo escuro"
                        data-tooltip="Modo escuro">
                        <svg x-show="!darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                        <svg x-show="darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                    </button>
                </div>

                <!-- Mobile menu button -->
                <button @click="mobileMenuOpen = !mobileMenuOpen"
                    class="md:hidden p-2 hover:bg-blue-700 rounded-lg transition"
                    aria-label="Menu mobile"
                    aria-expanded="false"
                    :aria-expanded="mobileMenuOpen">
                    <svg x-show="!mobileMenuOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                    <svg x-show="mobileMenuOpen" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Mobile menu -->
            <div x-show="mobileMenuOpen"
                x-transition:enter="transition ease-out duration-200"
                x-transition:enter-start="opacity-0 transform -translate-y-2"
                x-transition:enter-end="opacity-100 transform translate-y-0"
                x-transition:leave="transition ease-in duration-150"
                x-transition:leave-start="opacity-100 transform translate-y-0"
                x-transition:leave-end="opacity-0 transform -translate-y-2"
                class="md:hidden mt-4 pb-4 space-y-2"
                role="menu">
                <a href="{% url 'fundamentos:index' %}" class="block py-2 px-4 hover:bg-blue-700 rounded-lg transition" role="menuitem">
                    Busca
                </a>
                <a href="{% url 'fundamentos:arvore' %}" class="block py-2 px-4 hover:bg-blue-700 rounded-lg transition" role="menuitem">
                    Árvore
                </a>
                <a href="/api/fundamentos/" class="block py-2 px-4 hover:bg-blue-700 rounded-lg transition" target="_blank" role="menuitem">
                    API
                </a>
                <button @click="darkMode = !darkMode" class="w-full text-left py-2 px-4 hover:bg-blue-700 rounded-lg transition" role="menuitem">
                    <span x-text="darkMode ? 'Modo claro' : 'Modo escuro'"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main content -->
    <main id="main-content" class="max-w-7xl mx-auto px-4 py-6 md:py-8" role="main">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12 py-6" role="contentinfo">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center text-sm">
                <p class="font-medium">Sistema de Fundamentos Legais - Superior Tribunal de Justiça</p>
                <p class="text-gray-400 mt-1">Pressione <kbd class="px-2 py-1 bg-gray-700 rounded text-xs">Ctrl+K</kbd> para buscar</p>
            </div>
        </div>
    </footer>

    <!-- Global keyboard shortcuts -->
    <script>
        document.addEventListener('keydown', (e) => {
            // Ctrl+K or Cmd+K: Focus search
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                const searchInput = document.querySelector('input[type="text"]');
                if (searchInput) {
                    searchInput.focus();
                    searchInput.select();
                }
            }

            // Escape: Close modals/panels
            if (e.key === 'Escape') {
                Alpine.store('mobileMenuOpen', false);
            }
        });

        // Save dark mode preference
        document.addEventListener('alpine:init', () => {
            Alpine.data('darkMode', () => ({
                init() {
                    this.$watch('darkMode', value => {
                        localStorage.setItem('darkMode', value);
                    });

                    const saved = localStorage.getItem('darkMode');
                    if (saved !== null) {
                        this.darkMode = saved === 'true';
                    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                        this.darkMode = true;
                    }
                }
            }));
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>
